# iftop命令



> 欢迎阅读《每天一个Linux命令》系列！在本篇文章中，将说明 `iftop` 命令用法。

## 一、简介

`iftop` 是一个实时显示网络接口流量的工具，可以帮助你监控服务器的网络流量。下面是如何在 CentOS 7 上安装和使用 `iftop`，以及常用的命令参数。



## 二、安装iftop

在 CentOS 7 上，你需要先启用 `EPEL` 仓库，因为 `iftop` 工具位于这个仓库中。

### 1.安装 EPEL 仓库

```bash
yum install epel-release -y
```

### 2.安装 iftop

```bash
yum install iftop -y
```

### 3.验证安装

安装成功后，运行以下命令确认 `iftop` 是否安装成功：

```bash
iftop -h
```
如果显示帮助信息，表示安装成功。



## 三、使用iftop

### 1.常用参数说明

`iftop` 有许多参数和选项可以帮助你更好地监控和过滤网络流量。

常用参数：

- `-i`：指定网络接口 `iftop -i eth0`

- `-n`：不进行 DNS 解析，直接显示 IP 地址而非主机名，减少因 DNS 查询造成的延迟 `iftop -n`

- `-N`：显示端口号而不是服务名，`iftop -N`


  - `-b`：以字节为单位显示流量`iftop -b`


  - `-B`：使用位（bit）为单位显示流量`iftop -B`


  - `-P`：显示每个连接的端口号`iftop -P`


  - `-F`：显示指定网络段的流量（例如子网流量）`iftop -F 192.168.0.0/24`

### 2.常用交互按键

常用交互（`iftop` 运行后可用）：

- `h`：显示帮助信息

- `n`：切换显示 IP 地址或主机名

- `N`：切换显示端口号或服务名

- `t`：显示连接的发送和接收总流量

- `s`：切换显示源地址信息

- `d`：切换显示目标地址信息

- `p`：暂停显示更新

- `q`：退出 `iftop` ，按 **`q`** 键退出 `iftop` 界面。

### 3.使用示例

- 监控网络接口 `eth0` 并显示 IP 地址和端口号：
   ```bash
   iftop -i eth0 -n -P
   ```

- 监控网络接口 `eth0`，不显示主机名，只显示 IP 地址：
   ```bash
   iftop -i eth0 -n
   ```

- 以字节为单位显示流量，不解析主机名：
   ```bash
   iftop -i eth0 -n -b
   ```



## 四、流量信息分析

>[root@git-clash /data/mirrors]# iftop
>interface: `eth0`
>IP address is: `10.22.51.64`
>MAC address is: `00:50:56:ab:63:d6`
>                                 19.1Mb                           38.1Mb                           57.2Mb                           76.3Mb                      95.4Mb
>└────────────────────────────────┴────────────────────────────────┴────────────────────────────────┴────────────────────────────────┴─────────────────────────────────
>git-clash                                                             => 2402:f000:1:400::2                                                     880Kb   881Kb   881Kb
>                                                                      <=                                                                       19.7Mb  19.7Mb  19.8Mb
>zabbix                                                                => 10.18.12.27                                                           7.54Kb  4.31Kb  1.24Kb
>                                                                      <=                                                                        552b   1.30Kb   507b
>zabbix                                                                => 36.249.92.213                                                          640b   1.34Kb   344b
>                                                                      <=                                                                       3.29Kb  3.82Kb   979b
>zabbix                                                                => 10.18.89.91                                                           1.97Kb  1.88Kb  1.85Kb
>                                                                      <=                                                                        184b    184b    184b
>zabbix                                                                => 13.71.55.58                                                              0b      0b    296b
>                                                                      <=                                                                          0b      0b      0b
>zabbix                                                                => public2.alidns.com                                                       0b      0b     88b
>                                                                      <=                                                                          0b      0b    104b
>zabbix                                                                => reverse.gdsz.cncnet.net                                                  0b      0b      8b
>                                                                      <=                                                                          0b      0b     18b
>
>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
>TX:             cum:   9.16MB   peak:    971Kb                                                                                        rates:    890Kb   888Kb   884Kb
>RX:                     211MB           21.9Mb                                                                                                 19.7Mb  19.7Mb  19.8Mb
>TOTAL:                  220MB           22.8Mb                                                                                                 20.6Mb  20.6Mb  20.7Mb

 iftop 监控网络接口的实时流量信息分析：

1. **顶部信息：**
   - 左侧显示 `TX`（传输流量）和 `RX`（接收流量）的速率。
   - 右上方显示了不同的连接、传输速率、传输的方向、源 IP 地址、目的 IP 地址。

2. **中间部分（连接和流量信息）：**
   - 每一行表示一个网络连接。
   - **`=>`** 和 **`<=`** 表示数据的传输方向：
     - **`=>`**：从你的机器发送到外部目的地的流量（TX）。
     - **`<=`**：从外部来源接收的流量（RX）。
   - 左边是源 IP 地址，右边是目的 IP 地址，表示哪些连接正在使用网络带宽。
   - 在每一行的右边，你可以看到这条连接的带宽使用情况。

3. **底部汇总信息：**
   - **TX**：表示已传输数据的总量（总共传输的字节数）。
   - **RX**：表示已接收数据的总量。
   - **TOTAL**：总的传输和接收流量。
   - **rates**：当前的传输速率和接收速率（分别为 TX 和 RX）。
